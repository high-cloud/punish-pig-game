<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ¶è£è‡­çŒªå°æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow: hidden;
            cursor: crosshair;
        }

        .header {
            text-align: center;
            padding: 15px 10px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 10px;
            font-size: 0.9em;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        #game-area {
            position: relative;
            width: 100%;
            flex: 1;
            overflow: hidden;
        }

        .pig {
            position: absolute;
            font-size: 50px;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.1s;
            animation: appear 0.3s ease-out;
            touch-action: manipulation;
        }

        @keyframes appear {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .pig:hover {
            transform: scale(1.2);
        }

        .punishment {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            color: #ff4757;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            pointer-events: none;
            animation: fly-up 1s ease-out forwards;
        }

        @keyframes fly-up {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        .combo-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            pointer-events: none;
            animation: combo-pop 0.8s ease-out forwards;
            z-index: 1000;
        }

        @keyframes combo-pop {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.3);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .start-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 50px;
            font-size: 24px;
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 100;
        }

        .start-btn:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 200;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
        }

        .game-over.show {
            display: flex;
        }

        .game-over h2 {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .game-over p {
            font-size: 24px;
            margin-bottom: 30px;
        }

        .game-over button {
            padding: 15px 40px;
            font-size: 20px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
        }

        .explosion {
            position: absolute;
            pointer-events: none;
            animation: explode 0.5s ease-out forwards;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                display: flex;
                flex-direction: column;
                height: 100vh;
                height: 100dvh;
            }

            .header {
                padding: 10px 5px;
            }

            .header h1 {
                font-size: 1.4em;
                margin-bottom: 5px;
            }

            .stats {
                gap: 6px;
                font-size: 0.75em;
            }

            .stat-item {
                padding: 5px 10px;
            }

            #game-area {
                margin-top: 5px;
            }

            .pig {
                font-size: 45px;
            }

            .start-btn {
                padding: 15px 40px;
                font-size: 20px;
            }

            .game-over h2 {
                font-size: 32px;
            }

            .game-over p {
                font-size: 18px;
                margin-bottom: 20px;
            }

            .combo-text {
                font-size: 32px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>åˆ¶è£è‡­çŒªå¤§ä½œæˆ˜ ğŸ·</h1>
        <div class="stats">
            <div class="stat-item">å·²åˆ¶è£: <span id="score">0</span> æ¬¡</div>
            <div class="stat-item">è¿å‡»: <span id="combo">0</span>x</div>
            <div class="stat-item">æœ€é«˜è¿å‡»: <span id="max-combo">0</span>x</div>
            <div class="stat-item">æ—¶é—´: <span id="timer">30</span>s</div>
        </div>
    </div>

    <div id="game-area"></div>

    <button class="start-btn" id="start-btn">å¼€å§‹åˆ¶è£ï¼</button>

    <div class="game-over" id="game-over">
        <h2>åˆ¶è£ç»“æŸï¼</h2>
        <p>æ€»å…±åˆ¶è£äº† <span id="final-score">0</span> åªè‡­çŒª</p>
        <p>æœ€é«˜è¿å‡»: <span id="final-combo">0</span>x</p>
        <p id="rank"></p>
        <button onclick="restartGame()">å†æ¥ä¸€æ¬¡</button>
    </div>

    <script>
        const gameArea = document.getElementById('game-area');
        const startBtn = document.getElementById('start-btn');
        const scoreDisplay = document.getElementById('score');
        const comboDisplay = document.getElementById('combo');
        const maxComboDisplay = document.getElementById('max-combo');
        const timerDisplay = document.getElementById('timer');
        const gameOver = document.getElementById('game-over');

        let score = 0;
        let combo = 0;
        let maxCombo = 0;
        let timeLeft = 30;
        let gameInterval;
        let timerInterval;
        let comboTimeout;
        let isGameRunning = false;

        const punishments = [
            'è‡­çŒªï¼', 'æ¥æ‹›ï¼', 'å“ˆï¼', 'åˆ¶è£ï¼',
            'å•ªå•ªå•ªï¼', 'æ‰“ä½ ï¼', 'å“¼ï¼', 'åƒæˆ‘ä¸€å‡»ï¼',
            'åŒå‡»ï¼', 'ä¸‰è¿å‡»ï¼', 'æš´å‡»ï¼', 'å®Œç¾ï¼',
            'æ¼‚äº®ï¼', 'ä¸é”™ï¼', 'ç»§ç»­ï¼', 'åŠ æ²¹ï¼',
            'ç§’æ€ï¼', 'ç¥æ“ä½œï¼', 'å‰å®³ï¼', 'ç‰›ï¼'
        ];

        const pigEmojis = ['ğŸ·', 'ğŸ–', 'ğŸ½', 'ğŸ¥“', 'ğŸ–'];

        const ranks = [
            { min: 0, title: 'èœé¸Ÿåˆ¶è£è€… - è¿˜éœ€è¦å¤šç»ƒä¹ å“¦ï¼' },
            { min: 20, title: 'åˆæ ¼åˆ¶è£è€… - ä¸é”™çš„å¼€å§‹ï¼' },
            { min: 40, title: 'ç†Ÿç»ƒåˆ¶è£è€… - è¶Šæ¥è¶Šå¼ºäº†ï¼' },
            { min: 60, title: 'ç²¾è‹±åˆ¶è£è€… - å¾ˆå‰å®³ï¼' },
            { min: 80, title: 'å¤§å¸ˆåˆ¶è£è€… - å¤ªå¼ºäº†ï¼' },
            { min: 100, title: 'ä¼ è¯´åˆ¶è£è€… - æ— äººèƒ½æŒ¡ï¼' }
        ];

        function startGame() {
            score = 0;
            combo = 0;
            maxCombo = 0;
            timeLeft = 30;
            isGameRunning = true;

            scoreDisplay.textContent = score;
            comboDisplay.textContent = combo;
            maxComboDisplay.textContent = maxCombo;
            timerDisplay.textContent = timeLeft;

            startBtn.style.display = 'none';
            gameArea.innerHTML = '';

            gameInterval = setInterval(spawnPig, 800);
            timerInterval = setInterval(updateTimer, 1000);
        }

        function spawnPig() {
            if (!isGameRunning) return;

            const pig = document.createElement('div');
            pig.className = 'pig';
            pig.textContent = pigEmojis[Math.floor(Math.random() * pigEmojis.length)];

            // è·å–å®é™…çš„æ¸¸æˆåŒºåŸŸå°ºå¯¸
            const areaWidth = gameArea.clientWidth;
            const areaHeight = gameArea.clientHeight;

            // çŒªçš„å¤§å°ï¼ˆæ ¹æ®å±å¹•è‡ªé€‚åº”ï¼‰
            const pigSize = window.innerWidth <= 768 ? 50 : 70;

            // ç¡®ä¿çŒªå®Œå…¨åœ¨å¯è§åŒºåŸŸå†…
            const maxX = Math.max(0, areaWidth - pigSize);
            const maxY = Math.max(0, areaHeight - pigSize);

            pig.style.left = Math.random() * maxX + 'px';
            pig.style.top = Math.random() * maxY + 'px';

            // æ”¯æŒè§¦æ‘¸å’Œç‚¹å‡»
            pig.addEventListener('click', punishPig);
            pig.addEventListener('touchstart', (e) => {
                e.preventDefault();
                punishPig(e);
            }, { passive: false });

            gameArea.appendChild(pig);

            setTimeout(() => {
                if (pig.parentNode) {
                    pig.remove();
                    if (isGameRunning) {
                        combo = 0;
                        comboDisplay.textContent = combo;
                    }
                }
            }, 2000);
        }

        function punishPig(e) {
            if (!isGameRunning) return;

            const pig = e.target;

            score++;
            combo++;

            if (combo > maxCombo) {
                maxCombo = combo;
                maxComboDisplay.textContent = maxCombo;
            }

            scoreDisplay.textContent = score;
            comboDisplay.textContent = combo;

            // è·å–è§¦æ‘¸æˆ–ç‚¹å‡»åæ ‡
            let clientX, clientY;
            if (e.touches && e.touches.length > 0) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            showPunishment(clientX, clientY);

            if (combo >= 5) {
                showCombo(combo);
            }

            clearTimeout(comboTimeout);
            comboTimeout = setTimeout(() => {
                combo = 0;
                comboDisplay.textContent = combo;
            }, 1500);

            createExplosion(clientX, clientY);

            pig.remove();
        }

        function showPunishment(x, y) {
            const punishment = document.createElement('div');
            punishment.className = 'punishment';
            punishment.textContent = punishments[Math.floor(Math.random() * punishments.length)];
            punishment.style.left = x + 'px';
            punishment.style.top = y + 'px';
            document.body.appendChild(punishment);

            setTimeout(() => punishment.remove(), 1000);
        }

        function showCombo(comboCount) {
            const comboText = document.createElement('div');
            comboText.className = 'combo-text';
            comboText.textContent = comboCount + ' è¿å‡»ï¼';
            document.body.appendChild(comboText);

            setTimeout(() => comboText.remove(), 800);
        }

        function createExplosion(x, y) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.textContent = 'ğŸ’¥';
            explosion.style.left = x - 25 + 'px';
            explosion.style.top = y - 25 + 'px';
            explosion.style.fontSize = '50px';
            document.body.appendChild(explosion);

            setTimeout(() => explosion.remove(), 500);
        }

        function updateTimer() {
            timeLeft--;
            timerDisplay.textContent = timeLeft;

            if (timeLeft <= 0) {
                endGame();
            }
        }

        function endGame() {
            isGameRunning = false;
            clearInterval(gameInterval);
            clearInterval(timerInterval);

            document.getElementById('final-score').textContent = score;
            document.getElementById('final-combo').textContent = maxCombo;

            const rank = ranks.reverse().find(r => score >= r.min);
            document.getElementById('rank').textContent = rank.title;

            gameOver.classList.add('show');
        }

        function restartGame() {
            gameOver.classList.remove('show');
            startGame();
        }

        startBtn.addEventListener('click', startGame);
    </script>
</body>
</html>
